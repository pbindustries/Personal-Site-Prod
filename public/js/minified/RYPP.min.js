function onYouTubeIframeAPIReady(){$("[data-rypp]").each(function(t,i){$(i)[0].rypp_data_obj.onYTIframeAPIReadyCallback()})}var RYPP=function(t,i){"use strict";function e(t,i,e){if(void 0===i)return console.log("Youtube API V3 requires a valid API KEY.\nFollow the instructions at: https://developers.google.com/youtube/v3/getting-started"),!1;this.DOM={},this.options={},this.data={ytapi:{playlist_info:"https://www.googleapis.com/youtube/v3/playlists?part=snippet&id={{RESOURCES_ID}}&key={{YOUR_API_KEY}}",playlist:"https://www.googleapis.com/youtube/v3/playlistItems?part=snippet&maxResults=50&playlistId={{RESOURCES_ID}}&key={{YOUR_API_KEY}}",pl_ID:"",videolist:"https://www.googleapis.com/youtube/v3/videos?part=snippet,status&maxResults=50&id={{RESOURCES_ID}}&key={{YOUR_API_KEY}}"},temp_vl:[],firsttime:!0,ismobile:void 0!==window.orientation,ispopulated:!1},this.init(t,i,e)}return e.prototype={init:function(i,e,a){if(this.api_key=e,this.options={update_title_desc:!1,autoplay:!1,autonext:!0,loop:!0,mute:!1,debug:!1},void 0!==a&&t.extend(this.options,a),this.DOM={},this.DOM.$el=t(i),this.DOM.$playlc=this.DOM.$el.find(".RYPP-playlist"),this.DOM.$items=this.DOM.$el.find(".RYPP-items"),this.DOM.$videoc=this.DOM.$el.find(".RYPP-video"),this.DOM.$title=this.DOM.$el.find(".RYPP-title"),this.DOM.$desc=this.DOM.$el.find(".RYPP-desc"),this.DOM.$el[0].ytplayer=null,this.data.player_uid=Math.random().toString(16).substr(2,8),this.DOM.$el.attr("data-rypp",this.data.player_uid).find(".RYPP-video-player").attr("id","RYPP-vp-"+this.data.player_uid).attr("name","RYPP-vp-"+this.data.player_uid),this.options.debug&&console.log("Unique ID: RYPP-vp-"+this.data.player_uid),void 0===window.YT){var s=document.createElement("script"),o=document.getElementsByTagName("head")[0];s.src="https://www.youtube.com/iframe_api?version=3",o.appendChild(s)}else this.addAPIPlayer()},onYTIframeAPIReadyCallback:function(){this.addAPIPlayer()},updateTitleDesc:function(){var i=this.DOM.$el.attr("data-playlist"),e=this.data.ytapi.playlist_info.replace("{{RESOURCES_ID}}",i).replace("{{YOUR_API_KEY}}",this.api_key);t.ajaxSetup({cache:!1}),t.ajax(e,{context:this,dataType:"json",crossDomain:!0,error:function(){},success:function(t){this.DOM.$title.html(t.items[0].snippet.title),this.DOM.$desc.html(t.items[0].snippet.description)}})},populatePlaylist:function(){if(this.options.update_title_desc&&(this.options.debug&&console.log(this.data.player_uid+": Updating playlist title / desc"),this.updateTitleDesc()),this.options.debug&&console.log(this.data.player_uid+": Populating playlist"),this.DOM.$items.html("").append(t("<ol>")),this.DOM.$el.attr("data-playlist"))this.data.pl_ID=this.DOM.$el.attr("data-playlist"),this.getVideosFrom("playlist",this.data.pl_ID);else if(this.DOM.$el.attr("data-ids")){var i=this.DOM.$el.attr("data-ids");i=t.map(i.split(","),t.trim).join(","),this.getVideosFrom("videolist",i)}},addAPIPlayer:function(){var t=this;window.YTConfig={host:"https://www.youtube.com"},this.DOM.$el[0].ytplayer=new YT.Player("RYPP-vp-"+t.data.player_uid,{playerVars:{enablejsapi:1,rel:0,modestbranding:1,wmode:"transparent"},events:{onReady:function(){t.options.debug&&console.log(t.data.player_uid+": ytplayer ready"),t.onPlayerReady()},onStateChange:function(i){t.onPlayerStateChange(i)},onError:function(t){console.log(t)}}})},onPlayerReady:function(){this.options.debug&&console.log(this.data.player_uid+": ytplayer ready callback"),this.populatePlaylist()},onPlayerStateChange:function(t){var i=this;if(void 0!==t){-1===t.data&&this.data.firsttime&&(this.options.autoplay||this.data.ismobile||(this.DOM.$el[0].ytplayer.stopVideo(),this.data.firsttime=!1),this.options.mute&&this.DOM.$el[0].ytplayer.mute()),3===t.data&&this.data.ismobile&&this.data.firsttime&&setTimeout(function(){i.DOM.$el[0].ytplayer.stopVideo(),i.data.firsttime=!1},500);var e=null;0===t.data&&!this.data.ismobile&&this.options.autonext&&(0===(e=this.DOM.$items.find("li.selected").next()).length&&this.options.loop&&(e=this.DOM.$items.find("li").first()),e.trigger("click"))}},getVideosFrom:function(i,e,a){var s=this,o=this.data.ytapi[i].replace("{{RESOURCES_ID}}",e).replace("{{YOUR_API_KEY}}",this.api_key);void 0!==a&&(o+="&pageToken="+a),t.ajaxSetup({cache:!1}),t.ajax(o,{context:this,dataType:"json",crossDomain:!0,error:function(){},success:function(i){if("youtube#playlistItemListResponse"===i.kind){var e=[];if(t.map(i.items,function(t,i){void 0!==t.snippet.resourceId.videoId&&e.push(t.snippet.resourceId.videoId)}),s.data.temp_vl.push(e),void 0!==i.nextPageToken&&""!==i.nextPageToken)s.getVideosFrom("playlist",s.data.pl_ID,i.nextPageToken);else for(var a=0,o=s.data.temp_vl.length;a<o;a++)e=s.data.temp_vl.shift(),s.getVideosFrom("videolist",e.join(","))}else if("youtube#videoListResponse"===i.kind)for(var l=0,n=i.items.length;l<n;l++){var d=i.items[l];if(-1===t.inArray(d.status.uploadStatus,["rejected","deleted","failed"])&&void 0!==d.snippet.thumbnails){var p=d.id,r=d.snippet.title,h=d.snippet.channelTitle,u=d.snippet.thumbnails.default.url;s.addVideo2Playlist(p,r,h,u)}t.isEmptyObject(s.data.temp_vl)&&this.startPlayList()}}})},startPlayList:function(){var i=this.DOM,e=null,a=this;i.$items.on("click","li",function(s){s.preventDefault(),i.$items.find("li").removeClass("selected"),t(this).addClass("selected"),e=t(this).data("video-id"),a.DOM.$el[0].ytplayer.loadVideoById(e),a.data.ismobile&&(a.data.firsttime=!0)}),0===i.$items.find("li.selected").length&&this.options.autoplay&&i.$items.find("li").first().click()},addVideo2Playlist:function(i,e,a,s){var o=this.DOM;t('<li data-video-id="'+i+'"><p class="title">'+e+'<small class="author"><br>'+a+'</small></p><img src="'+s+'" class="thumb"></li>').appendTo(o.$items.find("ol"))}},e}(jQuery);$.fn.rypp=function(t,i){return this.each(function(){this.rypp_data_obj=new RYPP(this,t,i)})};